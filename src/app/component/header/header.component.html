<!-- -------------------------header--------------------------- -->
<div class="nav">
  <div class="sticky">

    <!-- LEFT -->
    <div class="nav-left">
      <div class="amazon hover">
        <a routerLink="">
          <img src="../../../assets/amz/amazoni1.png" alt="amazon.in">
        </a>
      </div>

      <div class="address hover">
        <div class="add">
          <i class="fa-solid fa-location-dot"></i>
          <b data-label>Select address</b>
        </div>
      </div>
    </div>

    <!-- SEARCH -->
    <div class="nav-search" #searchContainer>
      <select #categorySelect id="cat" [(ngModel)]="selectedCategory" (change)="adjustSelectWidth()">
        <option value="all">All</option>
        <option *ngFor="let category of categories" [value]="category.categoryTitle">
          {{ category.categoryTitle }}
        </option>
      </select>


      <input type="search" placeholder="Search Amazon.in" [(ngModel)]="searchText" (keydown.enter)="goToSearchResult()">

      <label class="sicon" (click)="goToSearchResult()">
        <i class="fa-solid fa-magnifying-glass"></i>
      </label>
    </div>

    <!-- RIGHT -->
    <div class="nav-right">

      <!-- LANGUAGE -->
      <div class="ind hover">
        <select class="add">
          <option value="EN">EN</option>
          <option value="AR">AR</option>
        </select>
      </div>

      <!-- ACCOUNT -->
      <div class="sign hover" (click)="toggleMenu(true)" (mouseenter)="toggleMenu(true)"
        (mouseleave)="toggleMenu(false)">

        <div class="signin no-login account-box" [routerLink]="!auth() ? ['/auth'] : null"
          [queryParams]="!auth() ? { state: 'login' } : null">

          <div class="account-top">
            <span class="hello">Hello,</span>

            <span style="font-weight: bold;" *ngIf="!auth()" (click)="toggleMenu(false)">
              Sign in
            </span>

            <span *ngIf="auth()" class="signin user">
              {{ username }}
            </span>

            <i class="fa-regular fa-user user-icon"></i>
          </div>

          <div class="account-bottom">
            <b>Account & Lists</b>
            <i class="fa-solid fa-caret-down"></i>
          </div>

        </div>

        <!-- DROPDOWN -->
        <div class="dropdown-menu" *ngIf="menuVisible && auth()">
          <div class="dropdown-item" *ngIf="!auth()" routerLink="/auth" [queryParams]="{ state: 'login' }"
            (click)="menuVisible = false">
            Login
          </div>

          <div class="dropdown-item" *ngIf="auth() && role === 'ADMIN'" routerLink="/dashboard"
            (click)="menuVisible = false">
            Dashboard
          </div>

          <div class="dropdown-item" *ngIf="auth()" routerLink="/user/profile" (click)="menuVisible = false">
            Account
          </div>

          <div class="dropdown-item" *ngIf="auth()" (click)="logout(); menuVisible = false">
            Logout
          </div>
        </div>
      </div>

      <!-- ORDERS -->
      <div *ngIf="auth()" routerLink="orders" class="orders hover">
        <b data-label>Orders</b>
      </div>

      <!-- CART -->
      <div routerLink="cart" class="cart hover">
        <span class="material-symbols-rounded">shopping_cart</span>
        <span class="cardCount">{{ count$ | async }}</span>

      </div>

    </div>
  </div>

  <div class="nav-main">
    <div #navContainer class="xshop">

      <a *ngFor="let category of categories" routerLinkActive="active_link"
        [routerLink]="['/categories', category.categoryTitle]">
        {{ category.categoryTitle }}
      </a>
    </div>
  </div>
</div>