<div class="product">

  <!-- Image -->
  <div class="image-container">
    <img [src]="product.imageUrls[0]" [alt]="product.productTitle" (click)="redirectToDetails(product.productId)" />
    <div class="discount-badge" *ngIf="product.discountPercent > 0">
      {{ product.discountPercent }}% OFF
    </div>
    <div class="stock-status" [ngClass]="{ 'in-stock': product.inStock, 'out-of-stock': !product.inStock }">
      {{ product.inStock ? 'In Stock' : 'Out of Stock' }}
    </div>
  </div>

  <!-- Title -->
  <h2 class="product-title" (click)="redirectToDetails(product.productId)">
    {{ product.productTitle | capitalize }}
  </h2>

  <!-- Bottom row: Prices + Cart + Quantity -->
  <div class="bottom-row">
    <div class="price-info">
      <span class="original-price" *ngIf="product.discountPercent > 0">{{ product.price | currency }}</span>
      <span class="discounted-price">{{ product.discountPrice || product.price | currency }}</span>
    </div>
    <!-- Cart button -->
    <button mat-icon-button class="btn-cart-icon" *ngIf="product.productVariations[0]?.color !== 'no_color'"
      (click)="open(product)" [disabled]="!product.inStock">
      <mat-icon>shopping_cart</mat-icon>
    </button>

    <button mat-icon-button class="btn-cart-icon" *ngIf="product.productVariations[0]?.color === 'no_color'"
      (click)="open2(product)" [disabled]="!product.inStock">
      <mat-icon>shopping_cart</mat-icon>
    </button>

    <!-- Quantity input -->
    <div class="quantity-row" *ngIf="product.productVariations[0]?.color === 'no_color'">
      <label class="quantity-label" for="quantity">Qty:</label>
      <input id="quantity" class="quantity-input" type="number" min="1" [max]="maxQuantity" [(ngModel)]="quantity" />
    </div>
  </div>
  <div *ngIf="quantity <= 0" class="error-message text-danger">
    Quantity must be greater than 0.</div>
  <div *ngIf="submitted && !validateQuantity2()" class="error-message text-danger mt-1">
    available stock ({{ maxQuantity }})
  </div>
</div>